IFSC:

create or replace PROCEDURE IFSC
AS
BEGIN

UPDATE IDI_IFSC_DIR_INFO SET
STATUS='INACTIVE',STATEID='DELETED';

MERGE INTO IDI_IFSC_DIR_INFO tgt
USING sfmsbr.IDI_IFSC_DIR_INFO src
ON (tgt.IDI_IFSC_CODE = src.IDI_IFSC_CODE) 
WHEN MATCHED THEN
UPDATE SET tgt.status = 'ACTIVE',tgt.STATEID='SAVED',
tgt.IDI_BANK_CODE =src.IDI_BANK_CODE,
tgt.IDI_RSVRD_CHAR=src.IDI_RSVRD_CHAR,
tgt.IDI_BRANCH_CODE=src.IDI_BRANCH_CODE,
tgt.IDI_LNG_CODE=src.IDI_LNG_CODE,
tgt.IDI_TRNG_FLG=src.IDI_TRNG_FLG,
tgt.IDI_BANK_NAME=src.IDI_BANK_NAME,
tgt.IDI_BRANCH_NAME=src.IDI_BRANCH_NAME,
tgt.IDI_CITY_NAME=src.IDI_CITY_NAME,
tgt.IDI_ADDRS=src.IDI_ADDRS,
tgt.IDI_USER_ID=src.IDI_USER_ID,
tgt.IDI_IFSC_DIR_INFO_VER=src.IDI_IFSC_DIR_INFO_VER,
tgt.IDI_MICR_CODE=src.IDI_MICR_CODE,
tgt.IDI_DISTRICT=src.IDI_DISTRICT,
tgt.IDI_STATE=src.IDI_STATE,
tgt.IDI_STD=src.IDI_STD,
tgt.IDI_PHONE=src.IDI_PHONE,
tgt.DM_LSTUPDDT=src.DM_LSTUPDDT

WHEN NOT MATCHED THEN
INSERT (tgt.IDI_IFSC_CODE,
tgt.IDI_BANK_CODE,
tgt.IDI_RSVRD_CHAR,
tgt.IDI_BRANCH_CODE,
tgt.IDI_LNG_CODE,
tgt.IDI_TRNG_FLG,
tgt.IDI_BANK_NAME,
tgt.IDI_BRANCH_NAME,
tgt.IDI_CITY_NAME,
tgt.IDI_ADDRS,
tgt.IDI_USER_ID,
tgt.IDI_IFSC_DIR_INFO_VER,
tgt.IDI_MICR_CODE,
tgt.IDI_DISTRICT,
tgt.IDI_STATE,
tgt.IDI_STD,
tgt.IDI_PHONE,
tgt.DM_LSTUPDDT,
tgt.STATUS,
tgt.CREATEDBY,
tgt.CREATEDON,
tgt.UPDATEDBY,
tgt.UPDATEDON,
tgt.STATEID
)
VALUES (src.IDI_IFSC_CODE, 
src.IDI_BANK_CODE,
src.IDI_RSVRD_CHAR,
src.IDI_BRANCH_CODE,
src.IDI_LNG_CODE,
src.IDI_TRNG_FLG,
src.IDI_BANK_NAME,
src.IDI_BRANCH_NAME,
src.IDI_CITY_NAME,
src.IDI_ADDRS,
src.IDI_USER_ID,
src.IDI_IFSC_DIR_INFO_VER,
src.IDI_MICR_CODE,
src.IDI_DISTRICT,
src.IDI_STATE,
src.IDI_STD,
src.IDI_PHONE,
src.DM_LSTUPDDT,
'ACTIVE',
'SFMS',
current_timestamp(6),
'SFMS',
current_timestamp(6),
'SAVED');
END IFSC;





Bank_Error:

create or replace PROCEDURE BANK_ERROR
AS
BEGIN

UPDATE BNK_ERROR_CODE SET
STATUS='INACTIVE',STATEID='DELETED';

MERGE INTO BNK_ERROR_CODE tgt
USING sfmsbr.BNK_ERROR_CODE src
ON (tgt.BNK_ERROR_CODE = src.BNK_ERROR_CODE) 
WHEN MATCHED THEN
UPDATE SET tgt.STATUS = 'ACTIVE',tgt.STATEID='SAVED',tgt.BNK_ERROR_DESC =src.BNK_ERROR_DESC

WHEN NOT MATCHED THEN
INSERT (tgt.BNK_ERROR_CODE,tgt.BNK_ERROR_DESC,tgt.STATUS,CREATEDBY,CREATEDON,UPDATEDBY,UPDATEDON,STATEID)
VALUES (src.BNK_ERROR_CODE, src.BNK_ERROR_DESC,'ACTIVE','SFMS',current_timestamp(6),'SFMS',current_timestamp(6),'SAVED');
END BANK_ERROR;